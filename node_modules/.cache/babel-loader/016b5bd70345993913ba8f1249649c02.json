{"ast":null,"code":"import _objectSpread from\"/home/dikmarti/metrics-api/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import Mock from'../mock';import shortId from'shortid';// import * as _ from \"lodash\";\nvar ChatDB={user:[{id:'7863a6802ez0e277a0f98534',name:'John Doe',avatar:'/assets/images/face-1.jpg',status:'online',chatInfo:[{chatId:'89564a680b3249760ea21fe77',contactId:'323sa680b3249760ea21rt47',unread:4,lastChatTime:'2017-06-12T02:10:18.931Z'},{chatId:'3289564a680b2134760ea21fe7753',contactId:'14663a3406eb47ffa63d4fec9429cb71',unread:0,lastChatTime:'2019-03-10T02:10:18.931Z'}]}],contacts:[{id:'323sa680b3249760ea21rt47',name:'Frank Powell',avatar:'/assets/images/faces/13.jpg',status:'online',mood:''},{id:'7863a6802ez0e277a0f98534',name:'John Doe',avatar:'/assets/images/face-1.jpg',status:'online',mood:''},{id:'14663a3406eb47ffa63d4fec9429cb71',name:'Betty Diaz',avatar:'/assets/images/faces/12.jpg',status:'online',mood:''},{id:'43bd9bc59d164b5aea498e3ae1c24c3c',name:'Brian Stephens',avatar:'/assets/images/faces/3.jpg',status:'online',mood:''},{id:'3fc8e01f3ce649d1caf884fbf4f698e4',name:'Jacqueline Day',avatar:'/assets/images/faces/16.jpg',status:'offline',mood:''},{id:'e929b1d790ab49968ed8e34648553df4',name:'Arthur Mendoza',avatar:'/assets/images/faces/10.jpg',status:'online',mood:''},{id:'d6caf04bba614632b5fecf91aebf4564',name:'Jeremy Lee',avatar:'/assets/images/faces/9.jpg',status:'offline',mood:''},{id:'be0fb188c8e242f097fafa24632107e4',name:'Johnny Newman',avatar:'/assets/images/faces/5.jpg',status:'offline',mood:''},{id:'dea902191b964a68ba5f2d93cff37e13',name:'Jeffrey Little',avatar:'/assets/images/faces/15.jpg',status:'online',mood:''},{id:'0bf58f5ccc4543a9f8747350b7bda3c7',name:'Barbara Romero',avatar:'/assets/images/faces/4.jpg',status:'offline',mood:''},{id:'c5d7498bbcb84d81fc72168871ac6a6e',name:'Daniel James',avatar:'/assets/images/faces/2.jpg',status:'offline',mood:''},{id:'97bfbdd9413e46efdaca2010400fe18c',name:'Alice Sanders',avatar:'/assets/images/faces/17.jpg',status:'offline',mood:''}],chatCollection:[{id:'89564a680b3249760ea21fe77',chats:[{contactId:'323sa680b3249760ea21rt47',text:'Do you ever find yourself falling into the “discount trap?”',time:'2018-02-10T08:45:28.291Z'},{contactId:'7863a6802ez0e277a0f98534',text:'Giving away your knowledge or product just to gain clients?',time:'2018-02-10T08:45:28.291Z'},{contactId:'323sa680b3249760ea21rt47',text:'Yes',time:'2018-02-10T08:45:28.291Z'},{contactId:'7863a6802ez0e277a0f98534',text:'Don’t feel bad. It happens to a lot of us',time:'2018-02-10T08:45:28.291Z'},{contactId:'323sa680b3249760ea21rt47',text:'Do you ever find yourself falling into the “discount trap?”',time:'2018-02-10T08:45:28.291Z'},{contactId:'7863a6802ez0e277a0f98534',text:'Giving away your knowledge or product just to gain clients?',time:'2018-02-10T08:45:28.291Z'},{contactId:'323sa680b3249760ea21rt47',text:'Yes',time:'2018-02-10T08:45:28.291Z'},{contactId:'7863a6802ez0e277a0f98534',text:'Don’t feel bad. It happens to a lot of us',time:'2018-02-10T08:45:28.291Z'}]},{id:'3289564a680b2134760ea21fe7753',chats:[{contactId:'14663a3406eb47ffa63d4fec9429cb71',text:'Do you ever find yourself falling into the “discount trap?”',time:'2019-03-10T08:45:28.291Z'},{contactId:'7863a6802ez0e277a0f98534',text:'Giving away your knowledge or product just to gain clients?',time:'2019-03-10T08:45:28.291Z'},{contactId:'14663a3406eb47ffa63d4fec9429cb71',text:'Yes',time:'2019-03-10T08:45:28.291Z'},{contactId:'7863a6802ez0e277a0f98534',text:'Don’t feel bad. It happens to a lot of us',time:'2019-03-10T08:45:28.291Z'}]}]};Mock.onGet('/api/chat').reply(function(config){var id=config.data;var chats=ChatDB.chatCollection.find(function(collection){return collection.id===id;}).chats;var response=chats.map(function(chat){var temp=ChatDB.contacts.find(function(user){return user.id===chat.contactId;});return _objectSpread(_objectSpread({},chat),temp);});return[200,response];});Mock.onGet('/api/chat/chat-room').reply(function(config){var _JSON$parse=JSON.parse(config.data),currentUser=_JSON$parse.currentUser,contactId=_JSON$parse.contactId;var chatUser=ChatDB.user.find(function(user){return user.id===currentUser;});var chatRoom=chatUser.chatInfo.find(function(chat){return chat.contactId===contactId;});if(chatRoom){var chats=ChatDB.chatCollection.find(function(collection){return collection.id===chatRoom.chatId;}).chats;var messageList=chats.map(function(chat){var temp=ChatDB.contacts.find(function(user){return user.id===chat.contactId;});return _objectSpread(_objectSpread({},chat),temp);});var response={chatId:chatRoom.chatId,messageList:messageList,recentListUpdated:false};return[200,response];}else{var chatId=shortId.generate();ChatDB.user.forEach(function(user){if(currentUser===user.id){user.chatInfo.push({chatId:chatId,contactId:contactId,lastChatTime:Date.now(),unread:0});}});ChatDB.chatCollection.push({id:chatId,chats:[]});var _response={chatId:chatId,messageList:[],recentListUpdated:true};return[200,_response];}});Mock.onGet('/api/chat/contacts/recent').reply(function(config){var temp={contact:''};var id=config.data;var contacts=ChatDB.user.find(function(user){return user.id===id;}).chatInfo;var response=contacts.map(function(contact){temp.contact=ChatDB.contacts.find(function(user){return user.id===contact.contactId;});return _objectSpread(_objectSpread({},temp.contact),contact);});return[200,response];});Mock.onGet('/api/chat/contacts/all').reply(function(config){var id=config.data;var response=ChatDB.contacts.filter(function(contact){return contact.id!==id;});return[200,response];});Mock.onGet('/api/chat/contacts').reply(function(config){var id=config.data;var response=ChatDB.contacts.find(function(contact){return contact.id===id;});return[200,response];});Mock.onPost('/api/chat/add').reply(function(config){var chatDetails=JSON.parse(config.data);var chatId=chatDetails.chatId;ChatDB.chatCollection.forEach(function(chatRoom){if(chatId===chatRoom.id){delete chatDetails.chatId;chatRoom.chats.push(_objectSpread({},chatDetails));}});var chats=ChatDB.chatCollection.find(function(chatRoom){return chatRoom.id===chatId;}).chats;var response=chats.map(function(chat){var temp=ChatDB.contacts.find(function(user){return user.id===chat.contactId;});return _objectSpread(_objectSpread({},chat),temp);});return[200,response];});","map":null,"metadata":{},"sourceType":"module"}